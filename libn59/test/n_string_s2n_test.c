#include "n_test.h"

#include <stdio.h>
#include <stdbool.h>
#include <math.h>

static void t(char *s) {
  n_err_t err = false;
  n_t n = n_s2n(s, &err);
  char str[N_PRINT_MAX_SIZE];
  printf("%30s: %s%s\n", s, n_print(n, str), err ? " ?" : "");
}

int main() {
  char s[16];
  for (int i = 0; i < 1; i++) {
    for (int j = -99; j <= 99; j++) {
      sprintf(s, "%lld.%s%02d",
              (long long) pow(10, i), j < 0 ? "-" : " " ,ABS(j));
      t(s);
    }
  }

  printf("\n\n== Correct representations of 0 ==\n\n");
  t("0");
  t("0.");
  t(".0");
  t("0.0");
  t("-0");
  t("-.0");
  t("0 0");
  t("0-0");
  t("-0-0");
  t("-0-1234");
  t("-0.00000000000000000000");
  t("-0.00000000000000000000000000      -99999999999999999");
  t("-0.00-00");
  t("00");

  printf("\n\n== Correct representations of 1 ==\n\n");
  t("1");
  t("1.");
  t("1.0");
  t("1 0");
  t("1-0");
  t("1.00000000000000000000   -000000000000");
  t("1.00000000000000000000   -0");
  t("1.00000000000000000000");
  t("1.00000000000000000000 0");
  t("1.00000000000000000000    0");
  t("1.0000000000000000000    0");
  t("1.000000000000000000    0");
  t("1.00000000000000000    0");
  t("1.0000000000000000    0");
  t("1.000000000000000    0");
  t("1.00000000000000    0");

  printf("\n\n== Correct representations of -1 ==\n\n");
  t("-1");
  t("-1.");
  t("-1.0");
  t("-1 0");
  t("-1-0");
  t("-1.00000000000000000000   -000000000000");

  printf("\n\n== Incorrect representations of 0 ==\n\n");
  t("");
  t("-");
  t(".");
  t("x");
  t("--0");
  t("0+00");
  t("+0");
  t("0 00 0");
  t("00 0.");
  t("0..0");

  printf("\n\n");
  t("0");
  t("1");
  t("1234567890");
  t("1234567890123");
  t("0.");
  t("123.");
  t("0.0");
  t("0.000");
  t("0.0001");
  t("-0.0001");
  t("1 99");
  t("1-99");
  t("123.456 03");
  t("123.456 3");
  t("123.456-3");
  t("123.456-03");
  t("123.456 100");
  t("123.456-110");
  t("123.456  1");
  t("123.456 -1");
  t(".1 0");

  printf("\n");

  // Several representations of 1.
  t("1");
  t("1.0");
  t("1.");
  t("01");
  t("1.000000000000000000000000000");
  t("1 0");
  t("1-0");
  t("1-00");

  printf("\n");

  // Several representations of -1.
  t("-1");
  t("-1.0");
  t("-1.");
  t("-01");
  t("-1.000000000000000000000000000");

  printf("\n");

  t("1234567890123");
  t(".1234567890123");
  t("12345678901234567890");
  t(".12345678901234567890");
  printf("\n");
  t("1 1234");
  t("1-1234");
  t(".0001 101");
  t("1234567890123-111");
  printf("\n");

  // String may have more than 13 digits with or without overflow.
  t(".0000000000000000000000000000000000000000000000000000000000000000000000000000000000000123-000");
  t(".0000000000000000000000000000000000000000000000000000000000000000000000000000000000000123-999");
  t(".0000000000000000000000000000000000000000000000000000000000000000000000000000000000123    999");
  t("1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890");
  t("12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901");

  printf("\n");

  t("1 123456789012348912384902");
  t("0 12345678901234");
  printf("\n");
  t("000.111");

  printf("\n");
  t("555.555555555555555");
}
